{
	"voice.filter.env" : {
		"patcher" : "voice.filter.env",
		"type" : "audio",
		"block_ui_patcher" : "blank.ui",
		"help_text" : "a single oscillator and a 2pole state variable filter with filter envelope and amplitude envelope. ideal as a building block for polyphonic synths, but useful for all sorts of things. also works at lfo rates and over long timescales. ££both envelopes feature 'accumulation' - when retriggered before the envelope has decayed to silence the remaining level is added to the new target level, so rolls can be set to build up by themselves (or down - when set negative it makes the envelope obey jaki leibzeit's rule of '2nd hit quieter'). the envelopes also have a loop control, when set <1 each repeat of the loop is a little lower, leading to a classic bouncing ball effect. ££the filters in this block are the sm devices zdf svf model. the filter feedback slider feeds the lp (positive values) or bp (negative values) back into the cutoff, through a 1 sample delay, which gives some interesting tones and may add subtle latching behaviours to the resonance.",
		"max_polyphony" : 0,
		"upsample" : 2,
		"latching_enable" : 1,
		"connections" : {
			"in" : { 
				"audio" : [ "fm", "mod" ],
				"midi" : [ "notes" ]
			},
			"out" : {
				"audio" : [ "osc ", "env" ],
				"midi" : ["through"]
			}
		},
		"groups" : [
			{ 
				"contains" : [0,1,4],
				"colour" : 24,
				"height" : 0
			},
			{
				"contains" : [26,26,27,28,29,30],
				"height" : 2,
				"colour" : -20
			},
			{
				"contains" : [5,25],
				"height" : 0.6,
				"header" : "modulation input targets"
			},
			{ 
				"contains" : [6,7,8,22],
				"colour" : 8,
				"height" : 0,
				"header" : "vca envelope"
			},
			{
				"contains" : [9,10,11,12],
				"height" : 0
			},
			{ 
				"contains" : [14,15,16,21],
				"colour" : -10,
				"height" : 0,
				"header" : "filter envelope"
			},
			{
				"contains" : [17,18,19,20],
				"height" : 0,
				"colour" : -12
			},
			{
				"contains" : [13,13,2,2,3,3,23,23,23,24,24,24,31,31,31],
				"height" : 0
			}
		],
		"panel" : {
			"parameters" : [0, 21]
		},
		"parameters" : [
			{
				"name" : "shape",
				"type" : "menu_f",
				"values" : ["sin", "tri", "saw", "pulse", "sqr", "tri"],
				"wrap" : 1,
				"default" : 0.33
			},
			{
				"name" : "range",
				"type" : "menu_i",
				"values" : ["-16|lfo","-15|lfo","-14|lfo","-13|lfo","-12|lfo","-11|lfo","-10|lfo","-9|lfo","-8|lfo","-7|lfo","-6|lfo","-5|sub","-4|sub","-3|osc","-2|osc","-1|osc","0|osc","1|osc","2|osc"],
				"error_scale" : 0.6,
				"wrap" : 0,
				"default" : 0.875
			},
			{
				"name" : "unstable_pitch",
				"type" : "float",
				"values" : ["uni", 0, 1, "lin"],
				"wrap" : 0,
				"nomap" : 1,
				"default" : 0.02 
			},
			{
				"name" : "_shape",
				"type" : "float",
				"values" : ["uni", 0, 1, "lin"],
				"nomap" : 1,
				"wrap" : 0,
				"default" : 0.02 
			},
			{
				"name" : "detune",
				"type" : "float",
				"values" : ["bi", -24, 24, "lin"],
				"error_scale" : 0,
				"wrap" : 0
			},
			{
				"name" : "fm mode",
				"type" : "menu_d",
				"nopervoice" : 1,
				"values" : ["lin fm" , "exp fm" , "sync" , "sync&fm", "cutoff"],
				"columns" : 1,
				"error_scale" : 0,
				"wrap" : 1,
				"default" : 0.3
			},
			{
				"name" : "attack",
				"type" : "float4",
				"values" : ["uni", 0.01, 60000, "exp1000" ],
				"wrap" : 0,
				"error_scale" : 2,
				"default" : 0
			},
			{
				"name" : "sustain",
				"type" : "float",
				"values" : ["uni", 0, 1, "lin" ],
				"wrap" : 0,
				"error_scale" : 0,
				"default" : 0
			},
			{
				"name" : "release",
				"type" : "float4",
				"values" : ["uni", 0.01, 60000, "exp1000"  ],
				"wrap" : 0,
				"error_scale" : 4,
				"default" : 0.45
			},
			{
				"name" : "curve",
				"type" : "menu_f",
				"values" : ["exp", "lin", "log" ],
				"wrap" : 0,
				"default" : 0.2
			},
			{
				"name" : "loop",
				"type" : "float",
				"values" : ["uni", 0, 1, "lin" ],
				"wrap" : 0,
				"default" : 0
			},
			{
				"name" : "vel->level",
				"type" : "float",
				"values" : ["bi", -1, 1, "lin" ],
				"wrap" : 0,
				"default" : 1
			},
			{
				"name" : "accum",
				"type" : "float",
				"values" : ["bi", -1, 1, "lin" ],
				"wrap" : 0,
				"default" : 0.5
			},
			{
				"name" : "porta-_mento",
				"type" : "float",
				"values" : ["uni", 0, 10000, "exp" ],
				"wrap" : 0,
				"default" : 0
			},
			{
				"name" : "attack",
				"type" : "float4",
				"values" : ["uni", 0.01, 60000, "exp1000"  ],
				"wrap" : 0,
				"error_scale" : 2,
				"default" : 0
			},
			{
				"name" : "sustain",
				"type" : "float",
				"values" : ["uni", 0, 1, "lin" ],
				"wrap" : 0,
				"error_scale" : 0,
				"default" : 0
			},
			{
				"name" : "release",
				"type" : "float4",
				"values" : ["uni", 0.01, 60000, "exp1000" ],
				"wrap" : 0,
				"error_scale" : 4,
				"default" : 0.15
			},
			{
				"name" : "curve",
				"type" : "menu_f",
				"values" : ["exp", "lin", "log" ],
				"wrap" : 0,
				"default" : 0
			},
			{
				"name" : "loop",
				"type" : "float",
				"values" : ["uni", 0, 1, "lin" ],
				"wrap" : 0,
				"default" : 0
			},
			{
				"name" : "vel->level",
				"type" : "float",
				"values" : ["bi", -1, 1, "lin" ],
				"wrap" : 0,
				"default" : 1
			},
			{
				"name" : "accum",
				"type" : "float",
				"values" : ["bi", -1, 1, "lin" ],
				"wrap" : 0,
				"default" : 0.5
			},
			{
				"name" : "filter env_amount",
				"type" : "float",
				"values" : ["bi", -2, 2, "lin" ],
				"wrap" : 0,
				"default" : 0.625
			},
			{
				"name" : "gain",
				"type" : "float",
				"values" : ["bi", -2, 2, "lin" ],
				"wrap" : 0,
				"default" : 0.75				
			},	
			{
				"name" : "attack_shape",
				"type" : "menu_b",
				"nopervoice" : 1,
				"forcelabel" : 1,
				"values" : ["attack_shape_regular", "attack_shape_mirror" ],
				"wrap" : 1,
				"default" : 0.3
			},	
			{
				"name" : "filter_attack_shape",
				"type" : "menu_b",
				"nopervoice" : 1,
				"forcelabel" : 1,
				"values" : ["filter_attack_regular", "filter_attack_mirror" ],
				"wrap" : 1,
				"default" : 0.3
			},
			{
				"name" : "mod target",
				"type" : "menu_d",
				"values" : ["shape" , "cutoff" , "aux in"],
				"nopervoice" : 1,
				"columns" : 1,
				"error_scale" : 0,
				"wrap" : 1,
				"default" : 0.1
			},
			{
				"name" : "frequency",
				"type" : "float",
				"values" : ["uni", 0,1, "exp"],
				"wrap" : 0,
				"default" : 0.5
			},	
			{
				"name" : "resonance",
				"type" : "float",
				"values" : ["uni",0,1,"lin"],
				"error_scale" : 0,
				"wrap" : 0,
				"default" : 0
			},
			{
				"name" : "lp/hp/bp mix",
				"type" : "menu_f",
				"values" : ["lp", "hp", "bp" ],
				"wrap" : 1,
				"default" : 0
			},
			{
				"name" : "key follow",
				"type" : "float",
				"values" : ["bi", -2, 2, "exp" ],
				"wrap" : 0,
				"default" : 0.7
			},
			{
				"name" : "filter feedback",
				"type" : "float",
				"values" : ["bi", -1, 1, "exp100" ],
				"wrap" : 0,
				"default" : 0.5
			},
			{
				"name" : "topology",
				"type" : "menu_b",
				"values" : ["filter_-> vca" , "vca ->_filter" ],
				"nopervoice" : 1,
				"columns" : 1,
				"error_scale" : 0,
				"wrap" : 1,
				"default" : 0.1
			}
		]
	}
}